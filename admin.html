<script>
  const API_BASE = "https://inidan-finder-production.up.railway.app";
  let pendingItems = [];

  async function loadPending() {
    const res = await fetch(`${API_BASE}/api/submissions?status=pending`);
    pendingItems = await res.json();

    const list = document.getElementById("pendingList");
    list.innerHTML = "";

    pendingItems.forEach((item, i) => {
      const div = document.createElement("div");
      div.classList.add("pending-item");
      div.innerHTML = `
        <div><strong>${item.title}</strong></div>
        <div>Type: ${item.mediaType}</div>
        <div>URL: <a href="${item.src}" target="_blank">${item.src}</a></div>
        <button onclick="handleApprove('${item.id}')">Approve</button>
        <button onclick="handleReject('${item.id}')">Reject</button>
      `;
      list.appendChild(div);
    });
  }

  async function handleApprove(id) {
    await fetch(`${API_BASE}/api/submissions/${encodeURIComponent(id)}`, {
      method: "PATCH",
      headers: { "Content-Type": "application/json" },
      body: JSON.stringify({ status: "approved" })
    });
    loadPending();
  }

  async function handleReject(id) {
    await fetch(`${API_BASE}/api/submissions/${encodeURIComponent(id)}`, {
      method: "PATCH",
      headers: { "Content-Type": "application/json" },
      body: JSON.stringify({ status: "rejected" })
    });
    loadPending();
  }

  loadPending();
</script>

